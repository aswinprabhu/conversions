#Grapher Converter

Grapher is a proprietary monitoring system that depends on RRD for it's tooling, so this converter will make calls to the RRD converter to convert all chart definitions. The Grapher converter will be used to convert the dashboard definitions which contains the charts.

This converter will create Dashboards and Alerts from Grapher dashboard definitions. The Alerts are used to create events on charts when specific conditions are reached. See below about what chart definitions are used to create the alerts.

##Grapher Converter Usage
The _item-to-convert_ is a JSON definition of the Grapher dashboards that are to be converted.  This JSON file can be produced by the Grapher database.

`java -cp wavefront-convert.jar com.wavefront.labs.convert.Convert <properties-file> <item-to-convert>`

            
##Grapher Properties
Core properties should have the following values
- `convert.converter=com.wavefront.labs.convert.input.grapher.GrapherConverter`
- `convert.generator=com.wavefront.labs.convert.output.WavefrontGenerator`
- `convert.expression.builder=com.wavefront.labs.convert.input.grapher.GrapherExpressionBuilder`

In addition to the Core properties you will also need the following
- `grapher.definitions.metrics`: this is a text file with a single metric rule per line which will be used by the Grapher Expression Builder to convert the metric names properly. The metric names in the file will be used to reverse engineer the 
names coming from the Grapher platform. This file is generated by using Wavefront API calls to find all existing metrics under a given prefix. Because of this, you need to send metrics to Wavefront before you can have their names be converted. 
Names not matched on this list will go through a default conversion process which attempts to reverse engineer the rule, but is prone to error. 
- `grapher.definitions.charts`: this is a JSON file which contains a definition of all the charts that are used within the dashboards to be converted. This JSON file can be produced from the Grapher database. 
- `grapher.dashboard.row.charts`: Number of charts per row that will be created in the output Wavefront dashboards.
- `grapher.alert.notifications`: Space separated list of notifications (email address, webhook, etc) to be specified when Alerts are created. 
- `grapher.filter.colo`: Some Grapher dashboards are meant to be filtered by Co-Location.  This is the string that will be used within chart definitions to contain that filter expression.  Should be `${host}${colo}`. Changing this will likely 
require a code change.

Since Grapher depends on RRD you will also need to specify the following RRD specific properties
- `rrd.rpn.prev.step`: RRD has a PREV function which will return the previous data point.  Wavefront uses the lag function to achieve this.  The lag function takes an argument which is time to go back.  This setting should be equivalent to the 
collection interval within RRD so that it only goes back 1 data point (collection interval) in time.